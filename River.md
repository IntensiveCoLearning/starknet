---
timezone: Pacific/Auckland
---

> è¯·åœ¨ä¸Šè¾¹çš„ timezone æ·»åŠ ä½ çš„å½“åœ°æ—¶åŒºï¼Œè¿™ä¼šæœ‰åŠ©äºä½ çš„æ‰“å¡çŠ¶æ€çš„è‡ªåŠ¨åŒ–æ›´æ–°ï¼Œå¦‚æœæ²¡æœ‰æ·»åŠ ï¼Œé»˜è®¤ä¸ºåŒ—äº¬æ—¶é—´ UTC+8 æ—¶åŒº
> æ—¶åŒºè¯·å‚è€ƒä»¥ä¸‹åˆ—è¡¨ï¼Œè¯·ç§»é™¤ # ä»¥åçš„å†…å®¹

timezone: Pacific/Honolulu # å¤å¨å¤·-é˜¿ç•™ç”³æ ‡å‡†æ—¶é—´ (UTC-10)

timezone: America/Anchorage # é˜¿æ‹‰æ–¯åŠ æ ‡å‡†æ—¶é—´ (UTC-9)

timezone: America/Los_Angeles # å¤ªå¹³æ´‹æ ‡å‡†æ—¶é—´ (UTC-8)

timezone: America/Denver # å±±åœ°æ ‡å‡†æ—¶é—´ (UTC-7)

timezone: America/Chicago # ä¸­éƒ¨æ ‡å‡†æ—¶é—´ (UTC-6)

timezone: America/New_York # ä¸œéƒ¨æ ‡å‡†æ—¶é—´ (UTC-5)

timezone: America/Halifax # å¤§è¥¿æ´‹æ ‡å‡†æ—¶é—´ (UTC-4)

timezone: America/St_Johns # çº½èŠ¬å…°æ ‡å‡†æ—¶é—´ (UTC-3:30)

timezone: America/Sao_Paulo # å·´è¥¿åˆ©äºšæ—¶é—´ (UTC-3)

timezone: Atlantic/Azores # äºšé€Ÿå°”ç¾¤å²›æ—¶é—´ (UTC-1)

timezone: Europe/London # æ ¼æ—å¨æ²»æ ‡å‡†æ—¶é—´ (UTC+0)

timezone: Europe/Berlin # ä¸­æ¬§æ ‡å‡†æ—¶é—´ (UTC+1)

timezone: Europe/Helsinki # ä¸œæ¬§æ ‡å‡†æ—¶é—´ (UTC+2)

timezone: Europe/Moscow # è«æ–¯ç§‘æ ‡å‡†æ—¶é—´ (UTC+3)

timezone: Asia/Dubai # æµ·æ¹¾æ ‡å‡†æ—¶é—´ (UTC+4)

timezone: Asia/Kolkata # å°åº¦æ ‡å‡†æ—¶é—´ (UTC+5:30)

timezone: Asia/Dhaka # å­ŸåŠ æ‹‰å›½æ ‡å‡†æ—¶é—´ (UTC+6)

timezone: Asia/Bangkok # ä¸­å—åŠå²›æ—¶é—´ (UTC+7)

timezone: Asia/Shanghai # ä¸­å›½æ ‡å‡†æ—¶é—´ (UTC+8)

timezone: Asia/Tokyo # æ—¥æœ¬æ ‡å‡†æ—¶é—´ (UTC+9)

timezone: Australia/Sydney # æ¾³å¤§åˆ©äºšä¸œéƒ¨æ ‡å‡†æ—¶é—´ (UTC+10)

timezone: Pacific/Auckland # æ–°è¥¿å…°æ ‡å‡†æ—¶é—´ (UTC+12)

---

# River

1. è‡ªæˆ‘ä»‹ç»

   æœ‰3å¹´å…¨æ ˆè½¯ä»¶å¼€å‘ç»éªŒï¼Œç†Ÿæ‚‰Javaã€Goã€JSã€Rustã€Solidityç­‰å¼€å‘è¯­è¨€ã€‚ç›®å‰æœ‰è€ƒè™‘åœ¨Starknetä¸Šæ„å»ºé¡¹ç›®çš„æƒ³æ³•ï¼Œå› æ­¤æ¥å­¦ä¹ Starknetç›¸å…³å¼€å‘çŸ¥è¯†ã€‚

2. ä½ è®¤ä¸ºä½ ä¼šå®Œæˆæœ¬æ¬¡æ®‹é…·å­¦ä¹ å—ï¼Ÿ

   ä¸€å®šä¼šå®Œæˆã€‚

## Notes

<!-- Content_START -->

### 2024.09.18

#### 1. ç¯å¢ƒå‡†å¤‡

1. ç¼–ç¨‹è¯­è¨€

   * `Cairo`: é€šè¿‡ä¸‹è½½`Scarb`å³å¯å®‰è£…ä½¿ç”¨

2. ç¼–ç ç¯å¢ƒ

   * `asdf`: æ˜¯ä¸€ä¸ªå·¥å…·ç‰ˆæœ¬ç®¡ç†å™¨ï¼Œèƒ½ä»¥é¡¹ç›®ä¸ºç»´åº¦ç®¡ç†å¤šç§ç¼–ç¨‹è¯­è¨€çš„è¿è¡Œæ—¶ç‰ˆæœ¬

   * `Scarb`: æ˜¯`Cairo`çš„åŒ…ç®¡ç†å™¨ï¼Œå°†`Cairo`ç¼–è¯‘å™¨å’Œ`Cairo`è¯­è¨€æœåŠ¡å™¨æ‰“åŒ…åˆ°äº†ä¸€èµ·

#### 2. å®‰è£…ç¯å¢ƒ

æ“ä½œç³»ç»Ÿï¼šMacOS Big Sur

1. å®‰è£…`asdf`

   1. å®‰è£…ä¾èµ–`coreutils`ã€`curl`ã€`git`ï¼Œå¦‚æœå·²ç»å®‰è£…è¿‡äº†å°±æ— éœ€å†å®‰è£…

      `brew install coreutils curl git`

   2. ä¸‹è½½`asdf`

      * å®˜æ–¹ä¸‹è½½æ–¹å¼ï¼š

        `git clone https://github.com/asdf-vm/asdf.git ~/.asdf --branch {version}`

      * ä½¿ç”¨`MacOS`è‡ªå¸¦å·¥å…·ä¸‹è½½ï¼š

        `brew install asdf`

   3. å®‰è£…`asdf`

      * ä½¿ç”¨çš„å®˜æ–¹çš„ä¸‹è½½æ–¹å¼

        å®‰è£…æ—¶éœ€è¦åœ¨`~/.bash_profile`æ–‡ä»¶ä¸‹æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š

        ~~~shell
        . "$HOME/.asdf/asdf.sh"
        . "$HOME/.asdf/completions/asdf.bash"
        ~~~

      * ä½¿ç”¨`brew`æ–¹å¼å®‰è£…

        å®‰è£…å®Œæˆåä¼šæç¤ºè®¾ç½®ç¯å¢ƒå˜é‡

        ~~~shell
        To use asdf, add the following line (or equivalent) to your shell profile
        e.g. ~/.profile or ~/.zshrc:
          . /opt/homebrew/opt/asdf/libexec/asdf.sh
        e.g. ~/.config/fish/config.fish
          source /opt/homebrew/opt/asdf/libexec/asdf.fish
        Restart your terminal for the settings to take effect.
        ~~~

        

   4. éªŒè¯

      æ‰§è¡Œ`source ~/.bash_profile `ä½¿ä¸Šé¢çš„é…ç½®ç”Ÿæ•ˆ

      æ‰§è¡Œ`asdf --version`åï¼Œæ˜¾ç¤ºä»¥ä¸‹å†…å®¹ï¼š

      ~~~shell
      v0.14.1-f00f759
      ~~~

2. å®‰è£…`Scarb`

   **é€šè¿‡`asdf`å®‰è£…**

   1. æ·»åŠ `scarb`æ’ä»¶

      ~~~shell
      asdf plugin add scarb
      ~~~

   2. æŸ¥çœ‹æ‰€æœ‰å¯å®‰è£…çš„ç‰ˆæœ¬

      ~~~shell
      asdf list-all scarb
      ~~~

   3. å®‰è£…æŒ‡å®šç‰ˆæœ¬

      ~~~shell
      # å®‰è£…æœ€æ–°ç‰ˆæœ¬
      asdf install scarb latest
      
      # æˆ–è€…æ ¹æ®ç‰ˆæœ¬å·å®‰è£…
      asdf install scarb 2.8.2
      ~~~

   4. è®¾ç½®å…¨å±€ç‰ˆæœ¬

      ~~~shell
      asdf global scarb latest
      ~~~

   **é€šè¿‡`curl`å‘½ä»¤å®‰è£…**

   ~~~shell
   curl --proto '=https' --tlsv1.2 -sSf https://docs.swmansion.com/scarb/install.sh | sh
   ~~~

### 2024.09.19

#### å˜é‡ä¸å¯å˜æ€§

* `Cairo`ä½¿ç”¨çš„æ˜¯**ä¸å¯å˜æ€§**çš„å†…å­˜æ¨¡å‹ï¼Œä¸€æ—¦å†™å…¥å†…å­˜å—åå°±**åªè¯»**ï¼Œä¸èƒ½è¢«é‡å†™ã€‚

å£°æ˜çš„å˜é‡é»˜è®¤æ˜¯**ä¸å¯å˜**çš„ã€‚

å¦‚æœéœ€è¦å£°æ˜å¯å˜çš„å˜é‡ï¼Œéœ€è¦ä½¿ç”¨å…³é”®å­—`mut`æ˜¾ç¤ºæŒ‡å®šï¼Œä¾‹å¦‚ï¼š

~~~rust
let mut x = 7;
~~~

#### å¸¸é‡

å£°æ˜å¸¸é‡ä½¿ç”¨å…³é”®å­—`const`ï¼Œä¾‹å¦‚ï¼š

~~~rust
const ONE_HOUR_IN_SECONDS: u32 = 3600;
~~~

* å¸¸é‡å’Œå˜é‡çš„åŒºåˆ«ï¼š
  * ç›¸åŒï¼šé»˜è®¤éƒ½æ˜¯ä¸å¯å˜çš„
  * ä¸åŒï¼šå¸¸é‡ä¸å¯ä½¿ç”¨å…³é”®å­—`mut`ä¿®é¥°

#### å˜é‡é®è”½

åœ¨ä¸åŒçš„**ä½œç”¨åŸŸ**ä¹‹é—´ï¼Œå£°æ˜å¤šä¸ª**åŒåå˜é‡**ï¼Œåå£°æ˜çš„å˜é‡åœ¨å…¶**ä½œç”¨åŸŸå†…**ä¼šé®è”½å‰é¢å£°æ˜çš„å˜é‡ã€‚

* å˜é‡é®è”½å’Œå¯å˜å˜é‡åœ¨åº•å±‚ä¸Šæ˜¯ç­‰ä»·çš„ï¼Œä¸åŒçš„åœ°æ–¹åœ¨äºé€šè¿‡å˜é‡é®è”½å¯ä»¥ä¿®æ”¹å˜é‡çš„ç±»å‹ã€‚

##### ğŸ’¡å»ºè®®

ï¼ˆæ¥è‡ª`Rust`ç¼–ç è§„èŒƒï¼‰

å˜é‡é®è”½åŠŸèƒ½åœ¨åŠŸèƒ½ä¸Šå±äºä¸€ç§ç»§æ‰¿å¼å¯å˜ã€‚ä»–ä¼šè¦†ç›–ä¹‹å‰çš„å˜é‡ç»‘å®šï¼Œè€Œåˆ›å»ºä¸€ä¸ªæ–°çš„åŒåçš„å˜é‡ç»‘å®šã€‚

1. åœ¨åŒä¸€ä¸ªä½œç”¨åŸŸä¸­ï¼Œéå¿…è¦æ—¶ä¸å®œé€šè¿‡æ–°å˜é‡å£°æ˜é®è”½æ—§å˜é‡å£°æ˜çš„æ–¹å¼æ¥ä¿®æ”¹å˜é‡ã€‚
2. åœ¨å­ä½œç”¨åŸŸå†…ä¿®æ”¹â€œå“¨å…µå˜é‡â€æ—¶ï¼Œåº”è¯¥é¿å…ä½¿ç”¨å˜é‡é®è”½åŠŸèƒ½ï¼Œé˜²æ­¢å¼•èµ·é€»è¾‘bugã€‚
3. å¦‚æœä½¿ç”¨å˜é‡é®è”½ï¼Œç¦æ­¢ç”¨ä¸åŒç±»å‹çš„å˜é‡é®è”½å‰ä¸€ä¸ªå˜é‡ï¼Œå¦‚æœå®ç°åŒä¸€ä¸ª `trait` çš„å¯ä»¥ä¾‹å¤–ã€‚

### 2024.09.20

#### æ•°æ®ç±»å‹

åœ¨`Cairo`ä¸­ï¼Œæ¯ä¸ªå€¼éƒ½æœ‰æ˜ç¡®çš„æ•°æ®ç±»å‹ã€‚

* `Cairo`æ˜¯ä¸€é—¨**é™æ€ç±»å‹è¯­è¨€**ï¼Œæ„å‘³ç€åœ¨ç¼–è¯‘æœŸå°±è¦çŸ¥é“æ‰€æœ‰å˜é‡çš„ç±»å‹ã€‚



##### æ ‡é‡ç±»å‹ï¼ˆScalar Typesï¼‰

æ ‡é‡ç±»å‹ä»£è¡¨çš„æ˜¯å•ä¸ªå€¼ï¼Œæœ‰ä¸‰ä¸ªä¸»è¦çš„æ ‡é‡ç±»å‹ï¼š`felts`ã€`integers`ã€`booleans`

###### Felt Type

å¦‚æœå˜é‡æˆ–è€…å‚æ•°æ²¡æœ‰è¢«æŒ‡å®šæ˜ç¡®çš„ç±»å‹ï¼Œå®ƒçš„ç±»å‹é»˜è®¤æ˜¯ä¸€ä¸ª`field element`ï¼Œç”¨å…³é”®å­—`felt252`è¡¨ç¤ºã€‚

* `field element`ï¼šä¸€ä¸ªåœ¨$0 \leq x < P$èŒƒå›´å†…çš„æ•´å‹ã€‚å…¶ä¸­`P`æ˜¯ä¸€ä¸ªéå¸¸å¤§çš„ç´ æ•°ï¼Œç›®å‰ç­‰äº$2^{251} + 17 * 2^{192} + 1$ã€‚å¦‚æœæ•°å€¼åœ¨åšåŠ æ³•ã€å‡æ³•ã€æˆ–è€…ä¹˜æ³•æ—¶ï¼Œç»“æœçš„å¤§å°è¶…è¿‡è¿™ä¸ªèŒƒå›´ï¼Œåˆ™å¯¹`P`è¿›è¡Œæ¨¡è¿ç®—ã€‚

* `integers`ä¸`field elements`æœ€é‡è¦çš„åŒºåˆ«åœ¨äºé™¤æ³•ï¼š`integers`çš„é™¤æ³•ç»“æœæ˜¯å‘ä¸‹å–æ•´ï¼Œä¸ä¸€å®šæ»¡è¶³$\frac{x}{y} * y == x$ã€‚è€Œ`field elements`æ€»æ˜¯æ»¡è¶³è¿™ä¸€ç­‰å¼ã€‚



###### Integer Types

 åœ¨ä»»ä½•æ—¶å€™éƒ½å»ºè®®ä½¿ç”¨`integer`ç±»å‹ï¼Œè€Œä¸æ˜¯`felt252`ç±»å‹ï¼Œå› ä¸º`integer`ç±»å‹æœ‰é¢å¤–çš„å®‰å…¨ç‰¹å¾æ¥é¿å…ä»£ç ä¸­æ½œåœ¨çš„å®‰å…¨éšæ‚£ï¼Œæ¯”å¦‚ä¸Šæº¢å’Œä¸‹æº¢æ£€æŸ¥ã€‚



###### Boolean Types

ä½¿ç”¨`true`å’Œ`false`è¿™ä¸¤ä¸ªå­—é¢é‡ä½œä¸ºå€¼ï¼Œ`Boolean`ç±»å‹çš„å¤§å°ä¸ºä¸€ä¸ª`felt252`ã€‚å£°æ˜æ—¶ä½¿ç”¨å…³é”®å­—`bool`ã€‚



###### String Types

`Cairo`ä¸­æ²¡æœ‰ä¸ºå­—ç¬¦ä¸²æä¾›åŸç”Ÿç±»å‹ã€‚çŸ­å­—ç¬¦ä¸²ä½¿ç”¨å•å¼•å·è¡¨ç¤ºï¼Œ`ByteArray`å­—ç¬¦ä¸²ä½¿ç”¨åŒå¼•å·è¡¨ç¤º

* çŸ­å­—ç¬¦ä¸²ï¼šæ˜¯`ASCII`ç å­—ç¬¦ä¸²ã€‚æ¯ä¸ªå­—ç¬¦ç¼–ç ä¸º**ä¸€ä¸ªå­—èŠ‚**ã€‚

  `Cairo`ä¸­å­—ç¬¦ä¸²çš„ç±»å‹ä½¿ç”¨`felt252`ï¼Œç”±äº`felt252`æœ‰251æ¯”ç‰¹å¤§å°ï¼Œå› æ­¤ä¸€ä¸ªçŸ­å­—ç¬¦ä¸²çš„å¤§å°ä¸èƒ½è¶…è¿‡**31ä¸ªå­—ç¬¦**ï¼ˆ$31 * 8 = 248bi$tï¼‰

* `ByteArray`å­—ç¬¦ä¸²ï¼šä½¿ç”¨`ByteArray`ç±»å‹æ¥å¤„ç†è¶…è¿‡çŸ­å­—ç¬¦ä¸²å¤§å°çš„å­—ç¬¦ä¸²å’Œå­—èŠ‚åºåˆ—ã€‚

  `ByteArray`çš„å®ç°æœ‰ä¸¤éƒ¨åˆ†ç»„æˆï¼š

  1. ä¸€ä¸ª`bytes31`ä¸ªå­—çš„æ•°ç»„ï¼Œå…¶ä¸­æ¯ä¸ªå­—åŒ…å«31ä¸ªå­—èŠ‚çš„æ•°æ®
  2. ä¸€ä¸ªå¾…å®šçš„`felt252`çš„å­—ä½œä¸ºå°šæœªå¡«æ»¡å®Œæ•´`bytes31`ä¸ªå­—çš„å­—èŠ‚ç¼“å†²åŒº



##### å¤åˆç±»å‹ï¼ˆCompounds Typesï¼‰

###### å…ƒç»„ç±»å‹ï¼ˆTuple Typeï¼‰

ä¸€ä¸ªå…ƒç»„æ˜¯å°†è®¸å¤šçš„å¤šç§ç±»å‹çš„å˜é‡åˆ†ç»„ä¸ºä¸€ä¸ªå¤åˆç±»å‹çš„é€šç”¨æ–¹æ³•ã€‚å…ƒç»„çš„é•¿åº¦æ˜¯å›ºå®šçš„ï¼Œä¸€æ—¦å£°æ˜åï¼Œå…¶å¤§å°æ— æ³•å¢åŠ æˆ–è€…å‡å°‘ã€‚

~~~rust
fn main() {
    let tup: (u32, u64, bool) = (10, 20, true);
  
  	let (x, y, z) = tup;

    if y == 6 {
        println!("y is 6!");
    }
  
  	let (a, b): (felt252, felt252) = (2, 3);
}
~~~

**Unit Type**

ä¸€ä¸ªå•å…ƒç±»å‹åªæœ‰ä¸€ä¸ªå€¼`()`ã€‚å®ƒè¡¨ç¤ºä¸€ä¸ªæ²¡æœ‰å…ƒç´ çš„å…ƒç»„ï¼Œå®ƒçš„å¤§å°æ€»æ˜¯0ã€‚åœ¨ç¼–è¯‘çš„ä»£ç ä¸­æ˜¯ä¸å­˜åœ¨çš„ã€‚



###### å¤§å°å›ºå®šçš„æ•°ç»„ç±»å‹

ä¸€ä¸ªå¤§å°å›ºå®šçš„æ•°ç»„æ˜¯ä¸€ä¸ªåŒ…å«å¤šä¸ªå€¼çš„é›†åˆï¼Œå…¶ä¸­æ¯ä¸ªå€¼çš„ç±»å‹å¿…é¡»ç›¸åŒã€‚

~~~rust
fn main() {
    let arr1: [u64; 5] = [1, 2, 3, 4, 5];
  
    // [3, 3, 3, 3, 3]
  	let arr2 = [3; 5];
}
~~~



##### ç±»å‹è½¬æ¢

###### Into

`Into`ç‰¹å¾å…è®¸ä¸€ä¸ªç±»å‹æ¥å®šä¹‰å¦‚ä½•è½¬æ¢ä¸ºå¦ä¸€ç§ç±»å‹ã€‚å¯ä»¥è¢«ç”¨äºç¡®ä¿èƒ½è½¬æ¢æˆåŠŸçš„ç±»å‹è½¬æ¢ã€‚

æ‰§è¡Œå˜é‡çš„`into()`æ–¹æ³•è¿›è¡Œç±»å‹è½¬æ¢ã€‚è½¬æ¢çš„å˜é‡çš„ç±»å‹å¿…é¡»æ˜¾å¼å£°æ˜

~~~rust
fn main() {
    let my_u8: u8 = 10;
    let my_u16: u16 = my_u8.into();
    let my_u32: u32 = my_u16.into();
    let my_u64: u64 = my_u32.into();
    let my_u128: u128 = my_u64.into();

    let my_felt252 = 10;
    // As a felt252 is smaller than a u256, we can use the into() method
    let my_u256: u256 = my_felt252.into();
    let my_other_felt252: felt252 = my_u8.into();
    let my_third_felt252: felt252 = my_u16.into();
}
~~~



###### TryInto

åŠŸèƒ½ä¸`Into`ä¸€æ ·ç”¨äºç±»å‹è½¬æ¢ï¼Œä¸åŒçš„åœ°æ–¹åœ¨äºï¼Œ`TryInto`åœ¨å¯èƒ½ä¼šè½¬æ¢å¤±è´¥çš„åœºæ™¯ä¸‹ä½¿ç”¨ï¼Œè¿”å›`Option<T>`ï¼Œéœ€è¦ä½¿ç”¨`unwrap()`æ–¹æ³•è·å–è½¬æ¢åçš„å˜é‡å€¼ã€‚

~~~rust
fn main() {
    let my_u256: u256 = 10;

    // Since a u256 might not fit in a felt252, we need to unwrap the Option<T> type
    let my_felt252: felt252 = my_u256.try_into().unwrap();
    let my_u128: u128 = my_felt252.try_into().unwrap();
    let my_u64: u64 = my_u128.try_into().unwrap();
    let my_u32: u32 = my_u64.try_into().unwrap();
    let my_u16: u16 = my_u32.try_into().unwrap();
    let my_u8: u8 = my_u16.try_into().unwrap();

    let my_large_u16: u16 = 2048;
    let my_large_u8: u8 = my_large_u16.try_into().unwrap(); // panics with 'Option::unwrap failed.'
}
~~~



### 2024.09.21

#### å‡½æ•°

ä½¿ç”¨å…³é”®å­—`fn`å£°æ˜ä¸€ä¸ªå‡½æ•°ã€‚

å‡½æ•°çš„åç§°æ ¼å¼é€šå¸¸æ˜¯ä¸‹åˆ’çº¿æ ¼å¼ã€‚å¦‚ï¼š

~~~rust
fn another_function() {
    println!("Another function.");
}
~~~

#### å‚æ•°

å‚æ•°æ˜¯å‡½æ•°ç­¾åçš„ä¸€éƒ¨åˆ†ã€‚åœ¨å‡½æ•°ç­¾åä¸­ï¼Œå¿…é¡»å£°æ˜å‚æ•°çš„ç±»å‹ã€‚

~~~rust
fn print_labeled_measurement(value: u128, unit_label: ByteArray) {
    println!("The measurement is: {value}{unit_label}");
}
~~~

#### å‘½åå‚æ•°ï¼ˆNamed Parametersï¼‰

åœ¨`Cairo`ä¸­ï¼Œå½“è°ƒç”¨å‡½æ•°æ—¶ï¼Œå¯ä»¥æŒ‡å®šå‚æ•°çš„åç§°ã€‚å¯ä»¥è®©å‡½æ•°è°ƒç”¨æœ‰å¯è¯»æ€§å’Œè‡ªæè¿°æ€§ã€‚

è¯­æ³•ï¼š`parameter_name: value`ï¼Œå¦‚æœä¼ é€’çš„å˜é‡ä¸å‚æ•°çš„åç§°ä¸€æ ·æ—¶ï¼Œå¯ä»¥ç®€å†™ä¸º`:parameter_name`ã€‚

~~~rust
fn foo(x: u8, y: u8) {}

fn main() {
    let first_arg = 3;
    let second_arg = 4;
    foo(x: first_arg, y: second_arg);
    let x = 1;
    let y = 2;
    foo(:x, :y)
}
~~~



#### è¯­å¥ä¸è¡¨è¾¾å¼

* è¯­å¥ï¼šæ‰§è¡Œä¸€äº›æ“ä½œçš„æŒ‡ä»¤ï¼Œæ²¡æœ‰è¿”å›å€¼

  ~~~rust
  let y = 6;
  ~~~

* è¡¨è¾¾å¼ï¼šè¿›è¡Œæ±‚å€¼å¹¶å¾—åˆ°ç»“æœå€¼ã€‚å¯ä»¥æ˜¯ä¸€è¡Œä»£ç ï¼Œä¹Ÿå¯ä»¥æ˜¯ä»£ç å—ã€‚**æœ«å°¾æ²¡æœ‰åˆ†å·**ã€‚

  ~~~rust
  let y = {
    let x = 3;
    x + 1
  };
  ~~~



#### æ–¹æ³•è¿”å›å€¼

åœ¨`Cairo`ä¸­ï¼Œåœ¨å‡½æ•°ç­¾ååé¢çš„`->`ä¹‹åæ¥å£°æ˜è¿”å›å€¼ç±»å‹

~~~rust
fn plus_one(x: u32) -> u32 {
    x + 1
}
~~~



### 2024.09.22

#### æ³¨é‡Š

* æ™®é€šæ³¨é‡Šï¼šä»¥`//`å¼€å¤´

  ~~~rust
  fn main() -> felt252 {
      // this function performs a simple addition
      1 + 4
  }
  ~~~

* é¡¹ç›®çº§æ–‡æ¡£ï¼šä»¥`///`å¼€å¤´ã€‚æä¾›é¡¹ç›®çš„è¯¦ç»†æè¿°ï¼Œæ¯”å¦‚ç”¨æ³•ã€ä»»ä½•å¯èƒ½é€ æˆ`panic`çš„æ¡ä»¶

  ~~~rust
  /// Returns the sum of `arg1` and `arg2`.
  /// `arg1` cannot be zero.
  ///
  /// # Panics
  ///
  /// This function will panic if `arg1` is `0`.
  ///
  /// # Examples
  ///
  /// ```
  /// let a: felt252 = 2;
  /// let b: felt252 = 3;
  /// let c: felt252 = add(a, b);
  /// assert(c == a + b, "Should equal a + b");
  /// ```
  fn add(arg1: felt252, arg2: felt252) -> felt252 {
      assert(arg1 != 0, 'Cannot be zero');
      arg1 + arg2
  }
  ~~~

* æ¨¡å—çº§æ–‡æ¡£ï¼šä»¥`//!`å¼€å¤´ã€‚æä¾›æ•´ä¸ªæ¨¡å—çš„æ¦‚è¿°ï¼ŒåŒ…æ‹¬å…¶æ„å›¾å’Œç”¨ä¾‹ã€‚è¿™ç§æ–‡æ¡£ç±»å‹é€šå¸¸æè¿°æ¨¡å—æ˜¯åšä»€ä¹ˆçš„ä»¥åŠå¦‚ä½•ä½¿ç”¨ã€‚

  ~~~rust
  //! # my_module and implementation
  //!
  //! This is an example description of my_module and some of its features.
  //!
  //! # Examples
  //!
  //! ```
  //! mod my_other_module {
  //!   use path::to::my_module;
  //!
  //!   fn foo() {
  //!     my_module.bar();
  //!   }
  //! }
  //! ```
  mod my_module { // rest of implementation...
  }
  ~~~

### 2024.09.23

#### æµç¨‹æ§åˆ¶

##### ifè¡¨è¾¾å¼

###### å¸¸è§„å†™æ³•

~~~rust
fn main() {
    let number = 3;

    if number == 12 {
        println!("number is 12");
    } else if number == 3 {
        println!("number is 3");
    } else if number - 2 == 1 {
        println!("number minus 2 is 1");
    } else {
        println!("number not found");
    }
}
~~~

###### åœ¨letè¯­å¥ä¸­ä½¿ç”¨if

~~~rust
fn main() {
    let condition = true;
    let number = if condition {
        5
    } else {
        6
    };
}
~~~

##### å¾ªç¯æ§åˆ¶

 åœ¨`Cairo`ä¸­æœ‰ä¸‰ç§Loopå¾ªç¯ç±»å‹ï¼š`loop`ã€`while`ã€`for`

###### `loop`

* å¸¸è§„

  ~~~rust
  fn main() {
      loop {
          println!("again!");
      }
  }
  ~~~

* å¸¦æœ‰`break`å…³é”®å­—

  ~~~rust
  fn main() {
      let mut i: usize = 0;
      loop {
          if i > 10 {
              break;
          }
          println!("i = {}", i);
          i += 1;
      }
  }
  ~~~

* å¸¦æœ‰`continue`å…³é”®å­—

  ~~~rust
  fn main() {
      let mut i: usize = 0;
      loop {
          if i > 10 {
              break;
          }
          if i == 5 {
              i += 1;
              continue;
          }
          println!("i = {}", i);
          i += 1;
      }
  }
  ~~~

* å¸¦æœ‰è¿”å›å€¼

  ~~~rust
  fn main() {
      let mut counter = 0;
  
      let result = loop {
          if counter == 10 {
              break counter * 2;
          }
          counter += 1;
      };
  
      println!("The result is {}", result);
  }
  ~~~

###### `while`

~~~rust
fn main() {
    let mut number = 3;

    while number != 0 {
        println!("{number}!");
        number -= 1;
    };

    println!("LIFTOFF!!!");
}
~~~

###### `for`

~~~rust
fn main() {
    let a = [10, 20, 30, 40, 50].span();

    for element in a {
        println!("the value is: {element}");
    }
  
  	for number in 1..4_u8 {
        println!("{number}!");
    };
}
~~~

###### Loopsä¸é€’å½’

Loopså’Œé€’å½’æ˜¯ä¸¤ç§é‡å¤æ‰§è¡Œä»£ç çš„æ–¹å¼ã€‚

* `loop`å…³é”®å­—ç”¨æ¥åˆ›å»ºä¸€ä¸ªæ— é™å¾ªç¯ï¼ŒåŒæ—¶ä½¿ç”¨`break`å…³é”®å­—é€€å‡ºå¾ªç¯ã€‚

  ~~~rust
  fn main() -> felt252 {
      let mut x: felt252 = 0;
      loop {
          if x == 2 {
              break;
          } else {
              x += 1;
          }
      };
      x
  }
  ~~~

* é€’å½’é€šè¿‡åœ¨å‡½æ•°å†…éƒ¨è°ƒç”¨è‡ªèº«æ¥å®ç°

  ~~~rust
  fn main() -> felt252 {
      recursive_function(0)
  }
  
  fn recursive_function(mut x: felt252) -> felt252 {
      if x == 2 {
          x
      } else {
          recursive_function(x + 1)
      }
  }
  ~~~

åœ¨`Cairo`ä¸­ï¼ŒLoopsä¸é€’å½’ä¸ä»…ä»…åœ¨æ¦‚å¿µä¸Šæ˜¯ç­‰ä»·çš„ï¼ŒåŒæ—¶é€šè¿‡ç¼–è¯‘åœ¨åº•å±‚è¡¨è¾¾ä¸Šä¹Ÿç±»ä¼¼ã€‚



### 2024.09.24

#### æ•°ç»„

æ•°ç»„æ˜¯ä¸€ç³»åˆ—å…·æœ‰ç›¸åŒç±»å‹çš„å…ƒç´ çš„é›†åˆã€‚å¯ä»¥ä½¿ç”¨æ ¸å¿ƒåº“çš„ç‰¹å¾`ArrayTrait`æ¥åˆ›å»ºå’Œä½¿ç”¨æ•°ç»„ã€‚

âš ï¸ æ•°ç»„æ˜¯ä¸€ç§é˜Ÿåˆ—ï¼Œé‡Œé¢çš„å€¼æ— æ³•ä¿®æ”¹ã€‚äº‹å®ä¸Šä¸€æ—¦å†™å…¥åˆ°å†…å­˜æ§½ä¸­å°±æ— æ³•é‡å†™ï¼Œåªèƒ½è¯»å–ã€‚åœ¨æ•°ç»„ä¸­ï¼Œåªèƒ½åœ¨æœ€åæ·»åŠ å…ƒç´ ï¼Œä»¥åŠä»å‰é¢åˆ é™¤å…ƒç´ ã€‚

###### åˆ›å»ºæ•°ç»„

* `ArrayTrait::new()`
* `ArrayTrait::<T>::new();`

~~~rust
fn main() {
    let mut a = ArrayTrait::new();
    a.append(0);
    a.append(1);
    a.append(2);
  
  	let mut arr1 = ArrayTrait::<u128>::new();
  
		let mut arr2:Array<u128> = ArrayTrait::new();
}
~~~

###### æ›´æ–°æ•°ç»„

* æ·»åŠ å…ƒç´ ï¼š`append()`

* åˆ é™¤å…ƒç´ ï¼š`pop_front()`ã€‚ä¼šè¿”å›`Option`ï¼Œä½¿ç”¨`unwrap()`è·å–åˆ é™¤çš„å…ƒç´ ï¼Œå¦‚æœè¿”å›`Option::None`è¡¨ç¤ºæ•°ç»„æ˜¯ç©ºçš„

  ~~~rust
  fn main() {
      let mut a = ArrayTrait::new();
      a.append(10);
      a.append(1);
      a.append(2);
  
      let first_value = a.pop_front().unwrap();
      println!("The first value is {}", first_value);
  }
  ~~~

###### è¯»å–æ•°ç»„

* `get()`ï¼šè¿”å›`Option<Box<@T>>`ï¼Œå¦‚æœå…ƒç´ ä¸å­˜åœ¨åˆ™è¿”å›Noneï¼Œ
* `at()`ï¼š`arr.at(index)`å’Œ`arr[index]`ç­‰ä»·ï¼Œå¦‚æœä¸‹æ ‡ç›Šå¤„åˆ™ä¼šPanic



###### å®¹é‡ç›¸å…³çš„æ–¹æ³•

* `len()`ï¼šç¡®å®šæ•°ç»„çš„å…ƒç´ ä¸ªæ•°ï¼Œè¿”å›`usize`ç±»å‹çš„å€¼
* `is_empty()`ï¼šåˆ¤æ–­æ•°ç»„æ˜¯å¦ä¸ºç©º



###### `array!`Macro

å¦‚æœéœ€è¦åˆ›å»ºåœ¨ç¼–è¯‘æœŸå°±èƒ½ç¡®å®šå€¼çš„æ•°ç»„æ—¶ï¼Œå¯ä»¥ä½¿ç”¨`array!`æ¥ç®€åŒ–åˆ›å»ºå¸¦æœ‰å…ƒç´ çš„æ•°ç»„

~~~rust
let arr = array![1, 2, 3, 4, 5];
~~~



###### å­˜å‚¨å¤šç§ç±»å‹

å¯ä»¥ä½¿ç”¨`Enum`è‡ªå®šä¹‰çš„æ•°æ®ç±»å‹åœ¨æ•°ç»„ä¸­å­˜å‚¨å¤šç§æ•°æ®ç±»å‹

~~~rust
#[derive(Copy, Drop)]
enum Data {
    Integer: u128,
    Felt: felt252,
    Tuple: (u32, u32),
}

fn main() {
    let mut messages: Array<Data> = array![];
    messages.append(Data::Integer(100));
    messages.append(Data::Felt('hello world'));
    messages.append(Data::Tuple((10, 30)));
}
~~~



###### `Span`

`Span`æ˜¯ä¸€ç§è¡¨ç¤ºæ•°ç»„å¿«ç…§çš„ç»“æ„ã€‚

ç”¨æ¥åœ¨ä¸ä¿®æ”¹åŸæ•°ç»„çš„å‰æä¸‹ï¼Œæä¾›æ•°ç»„ä¸­å…ƒç´ çš„å®‰å…¨ä»¥åŠè®¿é—®æ§åˆ¶ã€‚

åœ¨å‡½æ•°é—´ä¼ é€’æ•°ç»„æˆ–è€…æ‰§è¡Œåªè¯»æ“ä½œçš„æ—¶å€™ï¼Œä¿è¯æ•°æ®å®Œæ•´æ€§å’Œé¿å…å€Ÿç”¨é—®é¢˜æ—¶éå¸¸æœ‰ç”¨ã€‚

ä½¿ç”¨æ–¹æ³•ï¼š`array.span()`



### 2024.09.25

#### å­—å…¸

 ##### å­—å…¸çš„åŸºç¡€ç”¨æ³•

åœ¨`Cairo`ä¸­ï¼Œé”®çš„ç±»å‹è¢«é™åˆ¶ä¸º`felt252`ï¼Œåªèƒ½æŒ‡å®šå€¼çš„æ•°æ®ç±»å‹ï¼Œåœ¨`Felt252Dict<T>`ä¸­ç”±`T`è¡¨ç¤ºã€‚

`Felt252Dict<T>`çš„æ ¸å¿ƒåŠŸèƒ½å®ç°äºç‰¹å¾`Felt252DictTrait`ï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰åŸºç¡€çš„æ“ä½œï¼š

1. `insert(felt252, T) -> ()`ï¼šå†™å…¥å€¼åˆ°å­—å…¸å®ä¾‹ä¸­
2. `get(felt252) -> T`ï¼šä»å­—å…¸ä¸­è¯»å–å€¼

ğŸŒ°ä¾‹å­ï¼šåˆ›å»ºä¸€ä¸ªå­—å…¸æ¥è¡¨ç¤ºä¸ªäººä¸ä½™é¢ä¹‹é—´çš„æ˜ å°„ï¼š

~~~rust
use core::dict::Felt252Dict;

fn main() {
    let mut balances: Felt252Dict<u64> = Default::default();

    balances.insert('Alex', 100);
    balances.insert('Maria', 200);

    let alex_balance = balances.get('Alex');
    assert!(alex_balance == 100, "Balance is not 100");

    let maria_balance = balances.get('Maria');
    assert!(maria_balance == 200, "Balance is not 200");
}
~~~

ğŸ’¡å°½ç®¡åœ¨`Cairo`ä¸­å†…å­˜æ˜¯ä¸å¯å˜çš„ï¼Œæ„å‘³ç€ä¸€ä¸ªå†…å­˜å•å…ƒåªèƒ½å†™å…¥ä¸€æ¬¡ï¼Œä½†æ˜¯`Felt252Dict<T>`ç±»å‹å±•ç¤ºäº†ä¸€ç§å…‹æœè¿™ä¸ªéšœç¢çš„æ–¹æ³•ã€‚

ä½¿ç”¨ä¸Šé¢çš„ä¾‹å­ï¼Œå¯¹å…¶ä¸­çš„ä¸€ä¸ªç”¨æˆ·ä¿®æ”¹å…¶ä½™é¢ï¼š

~~~rust
use core::dict::Felt252Dict;

fn main() {
    let mut balances: Felt252Dict<u64> = Default::default();

    // Insert Alex with 100 balance
    balances.insert('Alex', 100);
    // Check that Alex has indeed 100 associated with him
    let alex_balance = balances.get('Alex');
    assert!(alex_balance == 100, "Alex balance is not 100");

    // Insert Alex again, this time with 200 balance
    balances.insert('Alex', 200);
    // Check the new balance is correct
    let alex_balance_2 = balances.get('Alex');
    assert!(alex_balance_2 == 200, "Alex balance is not 200");
}
~~~

`Felt252Dict<T>`å…è®¸â€œé‡å†™â€ä»»ä½•é”®å¯¹åº”çš„å€¼ã€‚

å½“å®ä¾‹åŒ–`Felt252Dict<T>`åï¼Œæ‰€æœ‰çš„é”®å…³è”çš„å€¼è¢«å®ä¾‹åŒ–ä¸º0ã€‚æ„å‘³ç€å¦‚æœè¯»å–ä¸€ä¸ªä¸å­˜åœ¨çš„æ•°æ®åˆ™ä¼šè¿”å›0ï¼Œè€Œä¸æ˜¯é”™è¯¯æˆ–è€…æœªå®šä¹‰çš„å€¼ã€‚ä¹Ÿæ„å‘³ç€æ— æ³•ä»å­—å…¸ä¸­åˆ é™¤æ•°æ®ã€‚

### 2024.09.26

##### å­—å…¸åº•å±‚ç»“æ„

`Cairo`ä½¿ç”¨Entryåˆ—è¡¨æ¥å®ç°`Felt252Dict<T>`ã€‚æ¯ä¸ªEntryè¡¨ç¤ºä¸€æ¡å¯ä»¥è¿›è¡Œè¯»å–ã€æ›´æ–°ã€å†™å…¥æ“ä½œçš„è®°å½•ã€‚

Entryç»“æ„åŒ…å«ä¸‰ä¸ªå€¼ï¼š

1. `key`ï¼šç”¨äºè¯†åˆ«å­—å…¸çš„é”®å€¼å¯¹
2. `previous_value`ï¼šè¡¨ç¤º`key`çš„å‰ä¸€ä¸ªå€¼
3. `new_value`ï¼šè¡¨ç¤º`key`æ›´æ–°çš„å€¼

å¦‚æœä½¿ç”¨é«˜çº§ç»“æ„æ¥å®ç°`Felt252Dict<T>`ï¼Œ å¯ä»¥å®šä¹‰`Array<Entry<T>>`ï¼Œ`Entry<T>`çš„ç»“æ„å¯ä»¥æ˜¯ï¼š

~~~rust
struct Entry<T> {
    key: felt252,
    previous_value: T,
    new_value: T,
}
~~~

æ¯ä¸€æ¬¡ä¸`Felt252Dict<T>`äº¤äº’ï¼Œå°±ä¼šæ³¨å†Œä¸€ä¸ªæ–°çš„`Entry<T>`ï¼š

1. `get`æ“ä½œå°†æ³¨å†Œä¸€ä¸ªçŠ¶æ€æœªæ”¹å˜çš„entryï¼Œç„¶å`previous_value`å’Œ`new_value`å­˜å‚¨ä¸ºåŒä¸€ä¸ªå€¼ã€‚
2. `insert`æ“ä½œå°†æ³¨å†Œä¸€ä¸ªæ–°çš„`Entry<T>`ï¼Œ`new_value`ä¸ºå†™å…¥çš„å€¼ï¼Œ`previous_value`åˆ™æ˜¯å†™å…¥æ“ä½œä¹‹å‰çš„å€¼ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡å†™å…¥ï¼Œåˆ™ä¸º0ã€‚

ä½¿ç”¨Entryåˆ—è¡¨å±•ç¤ºäº†ä¸ºä½•ä¸å­˜åœ¨é‡å†™ï¼Œä»…ä»…æ˜¯åœ¨æ¯æ¬¡ä¸`Felt252Dict<T>`äº¤äº’åˆ›å»ºä¸€ä¸ªæ–°çš„å†…å­˜å•å…ƒã€‚

ğŸŒ°ä¾‹å­ï¼šåˆ†åˆ«æ›´æ–°å­—å…¸balanceçš„'Alex'å’Œ'Maria'ä¸¤ä¸ªå€¼ï¼š

~~~rust
balances.insert('Alex', 100_u64);
balances.insert('Maria', 50_u64);
balances.insert('Alex', 200_u64);
balances.get('Maria');
~~~

ä¸Šé¢çš„æ“ä½œå°†äº§ç”Ÿå¦‚ä¸‹entryåˆ—è¡¨ï¼š

|  key  | previous | new  |
| :---: | :------: | :--: |
| Alex  |    0     | 100  |
| Maria |    0     |  50  |
| Alex  |   100    | 200  |
| Maria |    50    |  50  |

è¿™ç§å®ç°æ–¹å¼æ„å‘³ç€æ¯æ¬¡è¯»å–æˆ–è€…å†™å…¥æ“ä½œï¼Œéƒ½ä¼šéå†æ•´ä¸ªentryåˆ—è¡¨æ¥æŸ¥æ‰¾ä¸`key`ç›¸åŒçš„æœ€è¿‘çš„é‚£ä¸ªentryã€‚ä¸€æ—¦æ‰¾åˆ°å¯¹åº”çš„entryï¼Œå®ƒçš„`new_value`ä¼šè¢«æå–å‡ºæ¥ï¼Œå¹¶æ·»åŠ åˆ°æ–°çš„entryçš„`previous_value`ä¸­ã€‚

ä¸å¸¸è§„è¯­è¨€ä¸åŒï¼Œ`Cairo`çš„ç›®çš„ä¹‹ä¸€æ˜¯ä½¿ç”¨STARKè¯æ˜ç³»ç»Ÿç”Ÿæˆè®¡ç®—å®Œæ•´æ€§çš„è¯æ˜ã€‚è¿™æ„å‘³ç€éœ€è¦éªŒè¯ç¨‹åºçš„æ‰§è¡Œæ˜¯æ­£ç¡®çš„ï¼Œå¹¶ä¸”åœ¨`Cairo`é™åˆ¶çš„èŒƒå›´å†…ã€‚å…¶ä¸­ä¸€ä¸ªè¾¹ç•Œæ£€æŸ¥åŒ…æ‹¬â€œ**å­—å…¸å‹ç¼©**â€ï¼ˆdictionary squashingï¼‰ï¼Œå®ƒéœ€è¦æ¯ä¸ªæ¡ç›®çš„æ—§å€¼å’Œæ–°å€¼çš„ä¿¡æ¯ã€‚

### 2024.09.27

#### å­—å…¸å‹ç¼©

ä¸ºäº†éªŒè¯`Cairo`ç¨‹åºä½¿ç”¨`Felt252Dict<T>`æ‰§è¡Œç”Ÿæˆçš„è¯æ˜æ˜¯æ­£ç¡®çš„ï¼Œéœ€è¦æ£€æŸ¥å­—å…¸æ²¡æœ‰è¢«éæ³•ç¯¡æ”¹ã€‚è¿™é‡Œé€šè¿‡`squash_dict`æ–¹æ³•æ¥å®ç°ï¼Œè¯¥æ–¹æ³•æ£€æŸ¥entryåˆ—è¡¨ä¸­çš„æ¯ä¸ªentryï¼Œå¹¶ä¸”æ£€æŸ¥å¯¹å­—å…¸çš„è®¿é—®åœ¨æ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹ä¸­æ˜¯å¦ä¿æŒä¸€è‡´ã€‚

å‹ç¼©è¿‡ç¨‹ï¼šç»™å®šæ‰€æœ‰é”®ä¸ºkçš„entryï¼ŒæŒ‰ç…§æ’å…¥é¡ºåºï¼ŒéªŒè¯ç¬¬iä¸ªentryçš„`new_value`æ˜¯å¦ç­‰äºç¬¬i+1ä¸ªentryçš„`previous_value`ã€‚

ğŸŒ°ä¾‹å­ï¼šç»™å®šä¸€å¼ entryåˆ—è¡¨ï¼š

|   key   | previous | new  |
| :-----: | :------: | :--: |
|  Alex   |    0     | 150  |
|  Maria  |    0     | 100  |
| Charles |    0     |  70  |
|  Maria  |   100    | 250  |
|  Alex   |   150    |  40  |
|  Alex   |    40    | 300  |
|  Maria  |   250    | 190  |
|  Alex   |   300    |  90  |

åœ¨å‹ç¼©ä¹‹åï¼Œentryåˆ—è¡¨å°†ä¸ºç²¾ç®€ä¸ºï¼š

|   key   | previous | new  |
| :-----: | :------: | :--: |
|  Alex   |    0     |  90  |
|  Maria  |    0     | 190  |
| Charles |    0     |  70  |

å¦‚æœç¬¬ä¸€å¼ è¡¨çš„å€¼æœ‰ä»»ä½•ä¿®æ”¹ï¼Œåœ¨è¿è¡Œæ—¶å‹ç¼©æ“ä½œå°†ä¼šå¤±è´¥ã€‚

#### å­—å…¸è§£æ„

å½“è¿è¡Œâ€œå­—å…¸çš„åŸºç¡€ç”¨æ³•â€ä¸€èŠ‚ä¸­çš„ä¾‹å­æ—¶ï¼Œå¹¶ä¸ä¼šæ‰§è¡Œå­—å…¸å‹ç¼©çš„æ“ä½œï¼Œä½†æ˜¯ç¨‹åºè¿˜æ˜¯ä¼šç¼–è¯‘æˆåŠŸã€‚è¿™æ˜¯å› ä¸ºå‹ç¼©æ“ä½œä¼šé€šè¿‡`Felt252Dict<T>`æ‰€å®ç°çš„`Destruct<T>`ç‰¹å¾æ¥è‡ªåŠ¨è°ƒç”¨ï¼Œè¿™ä¸ªè°ƒç”¨ä»…ä»…åœ¨å­—å…¸ç¦»å¼€å…¶ä½œç”¨åŸŸå‰æ‰§è¡Œ

### 2024.09.28

#### å­—å…¸çš„`Entry`å’Œ`Finalize`

`Cairo`æä¾›äº†`entry`å’Œ`finalize`æ–¹æ³•æ¥å¤åˆ¶å­—å…¸æ•°æ®ã€‚

* `entry`ï¼šé€šè¿‡ç»™å®šçš„`key`æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„entryã€‚ä¸€æ—¦è¢«è°ƒç”¨ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šè·å¾—å­—å…¸çš„æ‰€æœ‰æƒï¼Œå¹¶è¿”å›è¦æ›´æ–°çš„entryã€‚æ–¹æ³•ç­¾åå¦‚ä¸‹ï¼š

  ~~~rust
  fn entry(self: Felt252Dict<T>, key: felt252) -> (Felt252DictEntry<T>, T) nopanic
  ~~~

  ç¬¬ä¸€ä¸ªå‚æ•°æ¥è·å–å­—å…¸çš„æ‰€æœ‰æƒï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç”¨æ¥åˆ›å»ºåˆé€‚çš„entryã€‚è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªå…ƒç»„ï¼š`Felt252DictEntry<T>`è¡¨ç¤ºå­—å…¸çš„entryï¼Œ`T`è¡¨ç¤ºentryçš„å‰ä¸€ä¸ªå€¼ã€‚`nopanic`è¡¨ç¤ºè¯¥æ–¹æ³•ä¸ä¼šå‘ç”Ÿpanic

* `finalize`ï¼šå‘å­—å…¸ä¸­æ’å…¥entryï¼Œå¹¶è¿”å›å…¶æ‰€æœ‰æƒã€‚æ–¹æ³•ç­¾åå¦‚ä¸‹ï¼š

  ~~~rust
  fn finalize(self: Felt252DictEntry<T>, new_value: T) -> Felt252Dict<T>
  ~~~

ğŸŒ°ä¾‹å­ï¼š

è‡ªå®šä¹‰`get`æ–¹æ³•ï¼š

~~~rust
use core::dict::{Felt252Dict, Felt252DictEntryTrait};

fn custom_get<T, +Felt252DictValue<T>, +Drop<T>, +Copy<T>>(
    ref dict: Felt252Dict<T>, key: felt252
) -> T {
    // Get the new entry and the previous value held at `key`
    let (entry, prev_value) = dict.entry(key);

    // Store the value to return
    let return_value = prev_value;

    // Update the entry with `prev_value` and get back ownership of the dictionary
    dict = entry.finalize(prev_value);

    // Return the read value
    return_value
}
~~~

è‡ªå®šä¹‰`insert`æ–¹æ³•ï¼š

~~~rust
use core::dict::{Felt252Dict, Felt252DictEntryTrait};

fn custom_insert<T, +Felt252DictValue<T>, +Destruct<T>, +Drop<T>>(
    ref dict: Felt252Dict<T>, key: felt252, value: T
) {
    // Get the last entry associated with `key`
    // Notice that if `key` does not exist, `_prev_value` will
    // be the default value of T.
    let (entry, _prev_value) = dict.entry(key);

    // Insert `entry` back in the dictionary with the updated value,
    // and receive ownership of the dictionary
    dict = entry.finalize(value);
}
~~~

ä½¿ç”¨ä¸Šé¢è‡ªå®šä¹‰çš„`get`å’Œ`insert`æ–¹æ³•ï¼š

~~~rust
fn main() {
    let mut dict: Felt252Dict<u64> = Default::default();

    custom_insert(ref dict, '0', 100);

    let val = custom_get(ref dict, '0');

    assert!(val == 100, "Expecting 100");
}
~~~

### 2024.09.29

#### åŸç”Ÿä¸æ”¯æŒçš„ç±»å‹çš„å­—å…¸

â€‹        ä½¿ç”¨`Felt252Dict<T>`å…¶ä¸­çš„ä¸€æ¡é™åˆ¶æ¥è‡ª`Felt252DictValue<T>`ç‰¹å¾ã€‚è¿™ä¸ªç‰¹å¾å®šä¹‰äº†`zero_default`æ–¹æ³•ï¼Œå½“ä¸€ä¸ªå€¼åœ¨å­—å…¸ä¸­ä¸å­˜åœ¨æ—¶ä¼šè°ƒç”¨è¯¥æ–¹æ³•ã€‚åªæœ‰éƒ¨åˆ†å…¬å…±æ•°æ®ç±»å‹ï¼ˆæ¯”å¦‚å¤§å¤šæ•°çš„æ— ç¬¦å·æ•´å‹ã€`bool`å’Œ`felt252`ï¼‰å®ç°äº†è¯¥æ–¹æ³•ã€‚ä½†æ˜¯ä¸€äº›æ›´å¤æ‚çš„ç±»å‹ï¼ˆæ•°ç»„ã€ç»“æ„åŒ…æ‹¬`u256`ï¼‰åˆ™æ²¡æœ‰å®ç°ã€‚

â€‹        å¦‚æœè¦åˆ›å»ºåŸç”Ÿä¸æ”¯æŒçš„ç±»å‹çš„å­—å…¸æ—¶ï¼Œéœ€è¦æ‰‹åŠ¨å®ç°ä¸€äº›ç‰¹å¾ï¼Œæ¥è®©è¿™äº›æ•°æ®ç±»å‹æœ‰åˆæ³•çš„å­—å…¸å€¼ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨`Nullable<T>`æ¥åŒ…è£…æ•°æ®ç±»å‹ã€‚`Nullable<T>`æ˜¯ä¸€ä¸ªæ™ºèƒ½æŒ‡é’ˆç±»å‹ï¼Œå®ƒèƒ½æŒ‡å‘ä¸€ä¸ªå€¼æˆ–è€…å€¼ä¸å­˜åœ¨æ—¶ä¸º`null`ã€‚

ğŸŒ°ä¾‹å­ï¼šå°†`Span<felt252>`å­˜å‚¨åˆ°å­—å…¸ä¸­ï¼ˆä½¿ç”¨`Span<T>`è€Œä¸æ˜¯`Array<T>`çš„åŸå› æ˜¯åè€…æ²¡æœ‰å®ç°å­—å…¸çš„è¯»å–æ“ä½œæ‰€éœ€è¦çš„`Copy<T>`ç‰¹å¾ï¼‰

~~~rust
use core::dict::Felt252Dict;
use core::nullable::{NullableTrait, match_nullable, FromNullableResult};

fn main() {
    // Create the dictionary
    let mut d: Felt252Dict<Nullable<Span<felt252>>> = Default::default();

    // Create the array to insert
    let a = array![8, 9, 10];

    // Insert it as a `Span`
    d.insert(0, NullableTrait::new(a.span()));

    // Get value back
    let val = d.get(0);

    // Search the value and assert it is not null
    let span = match match_nullable(val) {
        FromNullableResult::Null => panic!("No value found"),
        FromNullableResult::NotNull(val) => val.unbox(),
    };

    // Verify we are having the right values
    assert!(*span.at(0) == 8, "Expecting 8");
    assert!(*span.at(1) == 9, "Expecting 9");
    assert!(*span.at(2) == 10, "Expecting 10");
}
~~~

### 2024.09.30

#### ä½¿ç”¨å­—å…¸å­˜å‚¨æ•°ç»„

* æ’å…¥æ“ä½œï¼šç®€å•ï¼Œä¸æ’å…¥å…¶ä»–ç±»å‹çš„æ•°æ®ç›¸ä¼¼

  ~~~rust
  use core::dict::Felt252Dict;
  
  fn main() {
      let arr = array![20, 19, 26];
      let mut dict: Felt252Dict<Nullable<Array<u8>>> = Default::default();
      dict.insert(0, NullableTrait::new(arr));
      println!("Array inserted successfully.");
  }
  ~~~

* è¯»å–æ“ä½œï¼šä½¿ç”¨`get`æ–¹æ³•è¯»å–å­—å…¸ä¼šåœ¨ç¼–è¯‘æ—¶æŠ¥é”™ã€‚å› ä¸º`get`æ–¹æ³•ä¼šå°è¯•åœ¨å†…å­˜ä¸­å¤åˆ¶æ•°ç»„ï¼Œä½†æ˜¯`Array<T>`æ²¡æœ‰å®ç°`Copy<T>`ç‰¹å¾ï¼Œæ— æ³•è¿›è¡Œå¤åˆ¶æ“ä½œã€‚

  ~~~rust
  use core::nullable::{match_nullable, FromNullableResult};
  use core::dict::Felt252Dict;
  
  fn main() {
      let arr = array![20, 19, 26];
      let mut dict: Felt252Dict<Nullable<Array<u8>>> = Default::default();
      dict.insert(0, NullableTrait::new(arr));
      println!("Array: {:?}", get_array_entry(ref dict, 0));
  }
  
  fn get_array_entry(ref dict: Felt252Dict<Nullable<Array<u8>>>, index: felt252) -> Span<u8> {
      let val = dict.get(0); // This will cause a compiler error
      let arr = match match_nullable(val) {
          FromNullableResult::Null => panic!("No value!"),
          FromNullableResult::NotNull(val) => val.unbox()
      };
      arr.span()
  }
  ~~~

  æ­£ç¡®çš„è¯»å–æ–¹å¼éœ€è¦ä½¿ç”¨åˆ°å­—å…¸çš„entryï¼Œè¿™æ ·å¯ä»¥è·å–æ•°ç»„çš„å¼•ç”¨è€Œä¸éœ€è¦è¿›è¡Œå¤åˆ¶ã€‚

  ~~~rust
  fn get_array_entry(ref dict: Felt252Dict<Nullable<Array<u8>>>, index: felt252) -> Span<u8> {
      let (entry, _arr) = dict.entry(index);
      let mut arr = _arr.deref_or(array![]);
      let span = arr.span();
      dict = entry.finalize(NullableTrait::new(arr));
      span
  }
  ~~~

* ä¿®æ”¹æ“ä½œï¼šåŒæ ·ä½¿ç”¨å­—å…¸çš„entryè¿›è¡Œæ“ä½œ

  ~~~rust
  fn append_value(ref dict: Felt252Dict<Nullable<Array<u8>>>, index: felt252, value: u8) {
      let (entry, arr) = dict.entry(index);
      let mut unboxed_val = arr.deref_or(array![]);
      unboxed_val.append(value);
      dict = entry.finalize(NullableTrait::new(unboxed_val));
  }
  ~~~

  

<!-- Content_END -->
